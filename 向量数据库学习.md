- [关键概念](#关键概念)
  - [索引类型](#索引类型)
  - [相似度计算方法](#相似度计算方法)
  - [向量数据库应用示例](#向量数据库应用示例)
- [使用限制](#使用限制)
  - [向量维度](#向量维度)
  - [操作限制](#操作限制)
- [数据类型](#数据类型)
- [AI 套件](#ai-套件)
  - [基本概念](#基本概念)
  - [约束与限制](#约束与限制)
- [Embedding](#embedding)
- [模型信息](#模型信息)
  - [相关 API](#相关-api)
- [查询参数 ef](#查询参数-ef)

# 关键概念
- 向量（Vector）

向量可以理解为一组数值的有序集合，通常用于表示某个对象或事物的属性或者特征。这些数值可以有不同的维度，每个维度都表示一个属性或特征。在机器学习和人工智能领域，向量常用于表示图像、文本、音频等数据，通过计算向量之间的距离或相似度来实现分类、聚类、检索等任务。

- OLAMA

OLAMA 是腾讯自研的向量引擎，具有高性能、高可用、简单易用等特点。它支持单索引10亿级向量规模，适用于 AI 运算、检索场景，已稳定服务于近40个线上业务。
实例（Instance）

实例是腾讯云中独立运行的数据库环境，是用户购买向量数据库服务的基本单位，以单独的进程存在。一个数据库实例可以包含多个由用户创建的数据库。 您可以在控制台创建、修改和删除实例。实例之间相互独立、资源隔离，相互之间不存在 CPU、内存、持久内存、IO 等抢占问题。

- 数据库（Database）

数据库是按照数据结构来组织、存储和管理数据的仓库，一个实例可以创建多个 Database。

- 集合（Collection）

在向量数据库中，集合是指一组文档组，类似于关系型数据库中的表，其中可包含多条文档数据。集合没有固定的结构，可以插入不同格式和类型的数据。向量数据库支持集合维度的多分片、多副本特性，可以在创建集合时按需指定分片数和副本数。

- 文档（Document）

在向量数据库中，集合 可以看作是一个表格，而 Document 可以看作是表格中的一行数据。每个 Document 代表一个完整的文档对象，包含了多个 Field，每个 Field 表示文档中的一个属性或字段。向量数据库的文档是一组键值对（key：value），每个文档都有一个唯一主键（id）和一个向量字段（vector）。在插入文档时，向量数据库不需要设置相同的字段，可以在插入数据时增加或删除字段。

- 字段（Field）

每个 Field 是一个键值对（key：value），表示文档中的一个属性或者字段。每个 Field 都有自己的类型和取值范围，可以是字符串、数字等不同类型的数据。

- 节点（Node）

从向量数据库集群的资源角度来看，节点是用于存储数据的资源单位。一个运行中的向量数据库实例通常包含很多个节点，集合的多个副本和分片会分布在若干个节点上。节点是组成向量数据库集群的基本单元之一。

- 分片（Shard）

为了支持更大规模的数据，集合一般会按某个维度分成多个部分，每个部分就是一个分片，分布在若干个节点（Node）上。为了保证可靠性和可用性，同一个集合的多个分片会分布在不同节点（Node）上。

- 副本（Replica）

同一个分片（Shard）的备份数据，一个分片至少会有2个副本。副本分片作为硬件故障时保护数据不丢失的冗余备份，并为向量检索和文档查询等读操作提供服务，确保数据库在面临节点故障和负载变化等挑战时仍能正常运行。

- 索引（Index）

索引是一种特殊的数据结构，用于快速查找和访问数据，存储在内存中。索引本身并不存储数据，而是存储指向数据存储位置的指针或键值对。Tencent Cloud VectorDB 支持 FLAT、HNSW 等常见的向量索引。索引介绍详见 向量检索。

- KNN（K-Nearest Neighbor Search）

KNN 指的是最近邻搜索（K-Nearest Neighbor Search），是一种基于暴力搜索的方法，它的原理是：计算待查询向量与数据库中所有向量之间的距离，然后按照距离从小到大排序，选择距离最近的 K 个向量作为查询结果。KNN 算法的优点是可以保证精确的结果，但是对于大规模的向量数据，计算量会非常大，效率较低。

- ANN（Approximate Nearest Neighbor Search）

ANN 表示近似最近邻搜索（Approximate Nearest Neighbor Search），是一种用于高维数据空间中快速查找最近邻点的方法。与精确最近邻搜索相比，ANN 牺牲了一定的精度以换取更高的搜索速度，因此在处理大规模数据集时具有较高的效率。ANN 方法通常会对数据进行预处理，从而在查询时减少计算距离的次数。ANN 算法的优点是速度快、效率高，但是相对于 KNN 算法来说，其结果可能不够精确。

- HNSW（Hierarchical Navigable Small World）

HNSW 是一种基于图的高维向量相似性搜索算法，全称为：Hierarchical Navigable Small World。它通过构建一张图来表示向量之间的相似度关系，并使用一些优化策略来加速搜索过程。

## 索引类型

向量数据库支持的向量索引类型大部分采用近似最近邻搜索（ANNS）。目前，支持如下类型。具体信息，请参见 索引与计算。

- FLAT 索引：向量会以浮点型的方式进行存储，不做任何压缩处理。搜索向量会遍历所有向量与目标向量进行比较
- HNSW 索引：全称为 Hierarchical Navigable Small World， 是基于图的索引，适合对搜索效率要求较高的场景。
- IVF 系列：全称为 Inverted File，IVF 系列索引的核心思想是将高维空间划分为多个聚类，并为每个聚类构建一个倒排文件。适用于高维向量数据的快速检索。

## 相似度计算方法
| 相似性计算方法  | 方法说明                                           |
|----------------|---------------------------------------------------|
| 内积（IP）   | 全称为 Inner Product，是一种计算向量之间相似度的度量算法，它计算两个向量之间的点积（内积），所得值越大越与搜索值相似。  |
|欧式距离（L2）| 全称为 Euclidean distance，指欧几里得距离，它计算向量之间的直线距离，所得的值越小，越与搜索值相似。L2在低维空间中表现良好，但是在高维空间中，由于维度灾难的影响，L2的效果会逐渐变差。  |
| 余弦相似度（COSINE   | 余弦相似度（Cosine Similarity）算法，是一种常用的文本相似度计算方法。它通过计算两个向量在多维空间中的夹角余弦值来衡量它们的相似程度。所得值越大越与搜索值相似。  |

## 向量数据库应用示例
- 大规模知识库：企业的私域数据存储在向量数据库中可构建外部知识库，帮助企业更好地管理和利用自己的数据资源。
- 推荐系统：向量数据库会基于用户特征进行向量存储与检索，最终筛选用户可能感兴趣的物品推荐给用户。
- 问答系统：向量数据库会基于问题信息进行向量存储与检索，并返回最相关的问题与对应的答案。
- 文本/图像检索：向量数据库对输入的图像和文本信息进行向量存储与检索，会找到最匹配输入信息的文本或图像结果。

# 使用限制
## 向量维度
一般不超过 4096
## 操作限制
- Search  
相似性检索按 ID 、Vectors 或者原始文本信息检索，每次最大可查询 20 条数据。
- Query/Update/Delete  
按 ID 检索每次最大可查询 1000 条数据。

# 数据类型
- vector  
向量字段的数据类型，每个向量维度的数据结构为 float32。
- string  
字符串，主键 ID 与标量字段支持的数据类型之一。
- uint64  
整型数值，用于存储整数数值，包含正整数、负整数和零。
- double  
双精度浮点型数值，用于存储浮点值。
- array  
数组类型，用于存储一组相同类型的数据元素。当前，数组元素仅支持 string 类型。

# AI 套件
## 基本概念
- 召回  

当我们谈到文档检索中的“召回”时，我们指的是根据用户查询（query）从大规模文档库中快速获取与查询相关的候选文档的过程。这一步骤是搜索引擎中的关键环节，决定了搜索结果的质量上限。让我举个例子来说明：

假设您在一个电商网站上搜索“智能手机”，搜索引擎首先会执行召回操作，从数百万个文档中筛选出与“智能手机”相关的候选商品。这些候选商品可能包括各种品牌、型号和价格范围的智能手机。接下来，这些候选商品会进一步经过排序和精排等步骤，以呈现给用户最相关且高质量的搜索结果。

因此，召回阶段的目标是快速获取候选文档，而后续的排序和精排阶段则进一步优化这些候选文档的顺序，以提供更好的用户体验。

- AI 类 Database

AI 类 Database 是专门用于 AI 套件上传和存储文件的向量数据库系统，可用于构建知识库。

- CollectionView

AI 类数据库文档组的集合视图，由多个 DocumentSet 组成，每个 DocumentSet 存储一组数据，对应一个文件数据。多个 DocumentSet 构成一个 CollectionView。

- DocumentSet

相对 Document，DocumentSet 是 AI 类数据库中存储在 CollectionView 中的非结构化数据，是文件被拆分成多个 Document 的集合。每个DocumentSet 存储一组数据，对应一个文件，是 CollectionView 下存储文件的最小单元。

- Metadata

文件元数据，指上传文件时所携带的文件元数据信息，可以包括文件的名称、作者、创建日期、文件类型等信息。所有元数据被自动解析为标量字段，以Key-Value格式存储。用户可根据元数据构建标量字段的 Filter 索引，以检索并管理文件。

- Word

词语，是智能文档检索中最小的分割粒度，通常由一个或多个字符组成。在结果召回时，将对召回段落中所有 Words 进行相似性计算，以便于根据词向量进一步对检索结果做精排。

## 约束与限制
当前支持导入数据库的文件类型包含： Markdown、PDF、Word、PPT

每次只能上传一个文件，Markdown 类型文件最大限制为 1MB，其余类型最大限制为 10MB

# Embedding
提供将非结构化数据转换为向量数据

向量数据库将原始文本数据转交给 Embedding 模型进行向量化，再将转换后的向量数据以及原始文本一并存储在向量数据库中

# 模型信息
快速测试并分析来源于 Massive Text Embedding Benchmark（MTEB）上排名靠前的模型，选择出综合性能较好、适合不同应用场景的模型。

## 相关 API
```
 /collection/create    创建集合    指定 Embedding 模型，配置输入文本的字段名及其输出的向量字段。
/document/upsert       插入数据    插入原始文本信息，将原始文本直接向量化，将原始文本与向量数据一并存入数据库。
/document/update       更新数据    更新之前写入的文本信息，自动向量化后存入数据库。
/document/search       检索数据    检索数据时，可根据输入的文本信息，自动向量化并检索与其最相似的数据。
```

# 查询参数 ef
ef（或者称为 efSearch）是指在执行相似性搜索时，每次搜索操作中要检查的候选向量的数量。具体来说，它控制了在搜索过程中需要遍历多少个向量以找到最相似的结果。

当您设置较小的 ef 值时，搜索速度会更快，但可能会错过一些相似的向量。相反，较大的 ef 值会提高搜索的准确性，但会增加搜索的计算成本和响应时间。

