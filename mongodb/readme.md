# mogodb vs es
MOGODB比ES优势：事务、灵活备份、跨集群数据同步

# 建库、建用户、授权
use modb_func;
db.createUser({user:"modb_func",pwd:"modb_func",roles:[{role:"readWrite",db:"modb_func"}]})

# 开发规范
```
1、命名规范
1.1 库名、集合名使用数字字母下划线,长度最多64个字符,推荐使用业务标识命名
1.2 不能和系统库重合(admin,local,test,config)
1.3 大小写敏感,推荐全部小写
1.4 集合名称禁止以system.开头
1.5 禁止使用_id比如向_id中写入自定义内容
1.6 索引建立命名统一以idx_开头命名

2、使用规范
2.1 建议同一集合内保持数据结构一致，为性能放弃集合内可以字段不一样的特性
2.2 针对超长文本采用压缩存储,防止查询导致网卡阻塞
2.3 研发评估数据量增长较大的表通知dba进行数据分片，研发提供分片键字段
2.4 查询语句一定要走索引,避免全表扫描
2.5 数组内元素查询需要使用 $elemMatch
2.6 更新脚本命名为*.js，脚步头部需要use 库语句，脚本多条语句时内部语句用分号分割

3、索引规范
3.1 索引也遵循联合索引最左匹配原则,建立联合索引时要注意
3.2 分片集合建立索引必须包涵分片键
3.3 规避索引失效场景: 正则表达式及非操作符，如 $nin, $not, 算术运算符，$mod等
3.4 尽量不为数组元素创建索引,一旦指定数组元素索引,MONGO会给数组每个元素都创建索引,导致整体索引体积迅速增大
3.5 建立索引需要使用后台建立语句，即加上 background:true
```
